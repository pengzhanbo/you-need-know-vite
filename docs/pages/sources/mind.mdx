---
title: 序言
---

import Mermaid from '@components/Mermaid'

## createServer

<Mermaid theme="forest" chart={`
flowchart TD
  CS(create server) ---> RC(resolve config) & M(middlewares)
  CS ---> WS(websocket) & MG(module graph) & FW(watcher)
  RC ----> HS & PC
  M ----> HS(http server)
  FW & MG --> PC(plugin container)
  MG & FW & WS ----> H(HMR)
  M & MG & WS & PC & FW --> S(vite dev server)
  HS & H ---> S
  RC --> S
  click RC href "/sources/resolve-config"
`}
/>


- `resolveConfig`: 加载解析 `vite.config` 配置文件
- `middlewares`: `connect` 实例，http开发服务
- `websocket`: ws 实现 node 服务与 client 间通信
- `moduleGraph`: 模块依赖图
- `watcher`: 文件监听器
- `plugin container`: 插件容器

## build

<Mermaid chart={`
flowchart TD
  subgraph build
  RC(resolve config) --> RS
  RS(resolve rollup option) --> R[rollup bundler]
  end
`}
/>

## preview

<Mermaid chart={`
flowchart TD
  subgraph preview
  RC(resolve config) --> HS(http server)
  end
`}
/>
